<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>破晓音乐</title>

<style>
@font-face {
    font-family: 'CustomFont';
    src: url('SuXinShiGuYinSongJian.ttf') format('truetype');
}

*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-weight:300;
}

body{
    background:#000;
    font-family:'CustomFont',sans-serif;
    overflow:hidden;
    color:#fff;
}

.player{
    width:100vw;
    height:100vh;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    position:relative;
}

/* ===== 主显示 ===== */
#title{
    font-size:96px;
    text-align:center;
    cursor:pointer;
    user-select:none;
    font-weight:400;
}

#lyric{
    margin-top:20px;
    font-size:36px;
    opacity:.85;
    min-height:1.4em;
}

/* ===== 按钮 ===== */
button{
    width:56px;
    height:56px;
    border-radius:50%;
    border:none;
    background:rgba(255,255,255,.2);
    color:#fff;
    cursor:pointer;
    font-size:18px;
}
button:hover{background:rgba(255,255,255,.5);}

.buttons,.top-buttons{
    position:absolute;
    display:flex;
    gap:12px;
    opacity:0;
    transition:.3s;
}

.buttons{bottom:20px;}
.top-buttons{top:20px;left:20px;flex-direction:column;}

.player:hover .buttons,
.player:hover .top-buttons{opacity:1;}

/* ===== 遮罩 ===== */
.mask{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.6);
    display:none;
    z-index:10;
}

/* ===== 模态 ===== */
.modal{
    position:fixed;
    inset:0;
    display:none;
    justify-content:center;
    align-items:center;
    z-index:11;
}

.modal-box{
    background:#111;
    width:420px;
    font-weight:300;
}

/* ===== 播放列表 ===== */
.playlist{
    position:fixed;
    left:0;
    top:0;
    width:300px;
    height:100%;
    background:#111;
    transform:translateX(-100%);
    transition:.3s;
    z-index:11;
    padding:20px;
    display:flex;
    flex-direction:column;
}

.playlist.show{transform:translateX(0);}

.playlist h3{
    font-size:18px;
    font-weight:400;
}

.playlist ul{
    list-style:none;
    margin-top:16px;
    overflow-y:auto;
    flex:1;
    padding-right:6px;
}

.playlist li{
    padding:10px 6px;
    cursor:pointer;
    color:#fff;
    opacity:.55;
    transition:.2s;
    font-size:15px;
}

.playlist li:hover{opacity:1;}

.playlist li.active{
    opacity:1;
    font-weight:400;
}

/* ===== 设置模态框 ===== */
#settingModal .modal-box{
    padding:32px;
    line-height:1.8;
}

#settingModal h2{
    font-size:26px;
    margin-bottom:24px;
    font-weight:400;
}

#settingModal p{
    font-size:17px;
    margin:22px 0 12px;
}

#settingModal label{
    display:block;
    font-size:15px;
    margin:8px 0;
}

#settingModal input[type="range"]{
    width:100%;
    margin-top:8px;
}

/* ===== 关于模态框 ===== */
.about-box{
    padding:32px;
    line-height:1.9;
}

.about-box h2{
    font-size:28px;
    margin-bottom:24px;
    text-align:center;
    font-weight:400;
}

.about-quotes{
    text-align:center;
    font-size:17px;
    opacity:.9;
}

.about-quotes p{
    margin:10px 0;
}

/* 版本区域可滚动 */
.about-version{
    margin-top:28px;
    font-size:15px;
    max-height:200px;
    overflow-y:auto;
    padding-right:8px;
}

.current-version{
    font-weight:400;
    margin-bottom:12px;
}

.about-version h3{
    margin:14px 0 10px;
    font-size:16px;
    font-weight:400;
}

.version-list{
    list-style:none;
    padding:0;
}

.version-list li{
    margin-bottom:14px;
}

.version-list strong{
    font-weight:400;
}

.version-list span{
    opacity:.6;
    margin-left:6px;
}

.version-list div{
    margin-top:6px;
    opacity:.8;
}

/* ===== 滚动条统一美化 ===== */
.playlist ul::-webkit-scrollbar,
.about-version::-webkit-scrollbar{
    width:6px;
}

.playlist ul::-webkit-scrollbar-thumb,
.about-version::-webkit-scrollbar-thumb{
    background:rgba(255,255,255,.25);
    border-radius:3px;
}

.playlist ul::-webkit-scrollbar-track,
.about-version::-webkit-scrollbar-track{
    background:transparent;
}
</style>
</head>

<body>

<div class="player">
    <div class="top-buttons">
        <button id="btnSetting">⚙</button>
        <button id="btnAbout">i</button>
        <button id="btnList">≡</button>
    </div>

    <div id="title">加载中…</div>
    <div id="lyric">&nbsp;</div>

    <div class="buttons">
        <button id="prev">◀</button>
        <button id="next">▶</button>
    </div>

    <audio id="audio"></audio>
</div>

<div class="playlist" id="playlist">
    <h3>歌曲列表</h3>
    <ul id="songList"></ul>
</div>

<div class="mask" id="mask"></div>

<!-- 关于 -->
<div class="modal" id="aboutModal">
    <div class="modal-box about-box">
        <h2>破晓音乐</h2>

        <div class="about-quotes">
            <p>孩儿立志出乡关，学不成名誓不还</p>
            <p>问苍茫大地，谁主沉浮</p>
            <p>今日长缨在手，何时缚住苍龙</p>
            <p>雄关漫道真如铁，而今迈步从头越</p>
            <p>数风流人物，还看今朝</p>
            <p>为有牺牲多壮志，敢教日月换新天</p>
            <p>待到山花烂漫时，她在丛中笑</p>
            <p>人民胜利今何在，满目新贵满目衰</p>
            <p>你们怎么办，只有天知道</p>
        </div>

        <div class="about-version">
            <p class="current-version">当前版本：V1.1.0</p>

            <h3>版本历史</h3>
            <ul class="version-list">
                <li>
                    <strong>V1.1.0</strong>
                    <span>（2026/01/09）</span>
                    <div>
                        1.新增设置功能：标题和歌词大小调整、显示模式切换<br>
                        2.新增歌曲列表功能，支持快速索引与切换<br>
						3.歌词功能正式加入（所有音乐有歌词）<br>
						4.新增收录8首音乐（辞九门回忆、鸳鸯戏、唐人恋曲、半壶纱、关山酒、春庭雪、赐我、折风渡夜）
                    </div>
                </li>
                <li>
                    <strong>V1.0.0</strong>
                    <span>（2026/01/07）</span>
                    <div>
						1.首次发布，收录3首音乐（弱水三千、东南苦行山和牵丝戏）<br>
						2.歌词试验功能（仅东南苦行山有歌词）
					</div>
                </li>
            </ul>
        </div>
    </div>
</div>

<!-- 设置 -->
<div class="modal" id="settingModal">
    <div class="modal-box">
        <h2>设置</h2>

        <p>模式</p>
        <label><input type="radio" name="mode" value="title"> 标题</label>
        <label><input type="radio" name="mode" value="title-lyric"> 标题-歌词</label>
        <label><input type="radio" name="mode" value="lyric"> 歌词</label>

        <p>标题大小</p>
        <input type="range" id="titleSize" min="40" max="140">

        <p>歌词大小</p>
        <input type="range" id="lyricSize" min="20" max="80">
    </div>
</div>

<script>
/* ===== 数据 ===== */
const musicList=[
 {title:"弱水三千",src:"music/003.mp3",lrc:"lrc/003.lrc",color:"#DC143C"},
 {title:"东南苦行山",src:"music/001.mp3",lrc:"lrc/001.lrc",color:"#3357FF"},
 {title:"牵丝戏",src:"music/002.mp3",lrc:"lrc/002.lrc",color:"#DC143C"},
 {title:"辞九门回忆",src:"music/004.mp3",lrc:"lrc/004.lrc",color:"#DC143C"},
 {title:"鸳鸯戏",src:"music/005.mp3",lrc:"lrc/005.lrc",color:"#DC143C"},
 {title:"唐人恋曲",src:"music/006.mp3",lrc:"lrc/006.lrc",color:"#DC143C"},
 {title:"半壶纱",src:"music/007.mp3",lrc:"lrc/007.lrc",color:"#DC143C"},
 {title:"关山酒",src:"music/008.mp3",lrc:"lrc/008.lrc",color:"#DC143C"},
 {title:"春庭雪",src:"music/009.mp3",lrc:"lrc/009.lrc",color:"#DC143C"},
 {title:"折风渡夜",src:"music/012.mp3",lrc:"lrc/012.lrc",color:"#DC143C"}
];

let currentIndex=0;
let currentTitle='';
let lyrics=[];

/* DOM */
const audio=document.getElementById('audio');
const title=document.getElementById('title');
const lyric=document.getElementById('lyric');
const songList=document.getElementById('songList');
const playlist=document.getElementById('playlist');
const mask=document.getElementById('mask');
const aboutModal=document.getElementById('aboutModal');
const settingModal=document.getElementById('settingModal');

/* 设置 */
const settings={
 mode:getCookie('mode')||'title-lyric',
 titleSize:+getCookie('titleSize')||96,
 lyricSize:+getCookie('lyricSize')||36
};

function setCookie(k,v){document.cookie=`${k}=${v};path=/;max-age=31536000`;}
function getCookie(k){
 const m=document.cookie.match(new RegExp('(^| )'+k+'=([^;]+)'));
 return m?m[2]:null;
}

function applySettings(){
    title.style.fontSize = settings.titleSize + 'px';
    lyric.style.fontSize = settings.lyricSize + 'px';

    // 统一先显示
    title.style.display = '';
    lyric.style.display = '';

    if(settings.mode === 'title'){
        title.textContent = currentTitle;
        lyric.style.display = 'none';
    }

    if(settings.mode === 'title-lyric'){
        title.textContent = currentTitle;
        // lyric 内容由 ontimeupdate 驱动
    }

    if(settings.mode === 'lyric'){
        lyric.style.display = 'none';
        // title 内容由 ontimeupdate 驱动
    }

    setCookie('mode', settings.mode);
    setCookie('titleSize', settings.titleSize);
    setCookie('lyricSize', settings.lyricSize);
}


async function loadLyrics(path){
 lyrics=[];
 lyric.innerHTML='&nbsp;';
 if(!path)return;
 const text=await fetch(path).then(r=>r.text());
 text.split('\n').forEach(l=>{
  const m=l.match(/\[(\d+):(\d+\.?\d*)](.*)/);
  if(m)lyrics.push({time:+m[1]*60+ +m[2],content:m[3]});
 });
}

async function loadMusic(i,play=true){
 currentIndex=i;
 const m=musicList[i];
 audio.src=m.src;
 currentTitle=m.title;
 title.textContent=currentTitle;
 title.style.color=m.color;
 lyric.style.color=m.color;
 await loadLyrics(m.lrc);
 applySettings();
 updatePlaylist();
 if(play)audio.play();
}

audio.ontimeupdate = () => {
    for(let i = lyrics.length - 1; i >= 0; i--){
        if(audio.currentTime >= lyrics[i].time){
            if(settings.mode === 'title-lyric'){
                lyric.textContent = lyrics[i].content || '';
            }
            if(settings.mode === 'lyric'){
                title.textContent = lyrics[i].content || currentTitle;
            }
            break;
        }
    }
};


function updatePlaylist(){
 songList.innerHTML='';
 musicList.forEach((m,i)=>{
  const li=document.createElement('li');
  li.textContent=m.title;
  if(i===currentIndex){
   li.classList.add('active');
   li.style.color=m.color;
  }else{
   li.style.color='#fff';
  }
  li.onclick=()=>loadMusic(i,true);
  songList.appendChild(li);
 });
}

prev.onclick=()=>loadMusic((currentIndex-1+musicList.length)%musicList.length,true);
next.onclick=()=>loadMusic((currentIndex+1)%musicList.length,true);
audio.onended=()=>next.onclick();
title.onclick=()=>audio.paused?audio.play():audio.pause();

function hideAll(){
 aboutModal.style.display='none';
 settingModal.style.display='none';
 playlist.classList.remove('show');
 mask.style.display='none';
}

btnSetting.onclick=()=>{hideAll();settingModal.style.display='flex';mask.style.display='block';};
btnAbout.onclick=()=>{hideAll();aboutModal.style.display='flex';mask.style.display='block';};
btnList.onclick=()=>{hideAll();playlist.classList.add('show');mask.style.display='block';};

mask.onclick=hideAll;
aboutModal.onclick=hideAll;
settingModal.onclick=hideAll;
document.querySelectorAll('.modal-box').forEach(b=>b.onclick=e=>e.stopPropagation());

document.querySelectorAll('[name=mode]').forEach(r=>{
 r.checked=r.value===settings.mode;
 r.onchange=()=>{settings.mode=r.value;applySettings();}
});
titleSize.value=settings.titleSize;
lyricSize.value=settings.lyricSize;
titleSize.oninput=e=>{settings.titleSize=e.target.value;applySettings();}
lyricSize.oninput=e=>{settings.lyricSize=e.target.value;applySettings();}

loadMusic(0,true);
</script>

</body>
</html>
